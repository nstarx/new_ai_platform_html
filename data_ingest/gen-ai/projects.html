<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <style>
        body {
            padding: 20px;
        }

        .project-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .project-card {
            border: 1px solid #ddd;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .project-card:hover {
            transform: scale(1.05);
            box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.15);
        }

        /* Styles for Select2 */
        .select2-container--default .select2-selection--multiple {
            border: 1px solid #ced4da;
            border-radius: 4px;
            padding: 6px 12px;
            min-height: 38px;
        }

        .select2-container--default .select2-selection--multiple .select2-selection__choice {
            background-color: #007bff;
            border-color: #007bff;
            color: white;
            margin-right: 5px;
            margin-bottom: 5px;
            padding: 2px 6px;
            border-radius: 4px;
        }
    </style>
</head>

<body>
    <h1>Project Management</h1>

    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="projects-tab" data-bs-toggle="tab" data-bs-target="#projects-tab-pane"
                type="button" role="tab" aria-controls="projects-tab-pane" aria-selected="true">Projects</button>
        </li>
    </ul>

    <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="projects-tab-pane" role="tabpanel" aria-labelledby="projects-tab"
            tabindex="0">
            <button class="btn btn-primary mt-3" data-bs-toggle="modal" data-bs-target="#createProjectModal">Create
                Project</button>

            <div id="project-grid" class="mt-3 project-grid"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#projectTags').select2({ placeholder: "Select tags" });
            $('#projectMembers').select2({ placeholder: "Select members" });

            function createProjectCard(title, tags, members, workflows) {
                const projectCard = document.createElement('div');
                projectCard.classList.add('project-card');
                projectCard.innerHTML = `
                    <h3>${title}</h3>
                    <p>Tags: ${tags.join(', ') || 'None'}</p>
                    <p>Members: ${members.join(', ') || 'None'}</p>
                    <p>Workflows: ${workflows.join(', ') || 'None'}</p>
                `;
                projectCard.addEventListener('click', () => {
                    window.location.href = `/project/${title.replace(/\s+/g, '-').toLowerCase()}`;
                });
                return projectCard;
            }

            const dummyProjects = [
                { title: "Project A", tags: ["feature", "ui"], members: ["user1@example.com"], workflows: ["rag"] },
                { title: "Project B", tags: ["bug"], members: ["user2@example.com", "user1@example.com"], workflows: ["data_processing"] },
                { title: "Project C", tags: ["documentation"], members: ["user3@example.com"], workflows: ["rag", "data_processing"] },
            ];

            const projectGrid = document.getElementById('project-grid');
            dummyProjects.forEach(project => {
                const card = createProjectCard(project.title, project.tags, project.members, project.workflows);
                projectGrid.appendChild(card);
            });

            document.getElementById('saveProjectBtn').addEventListener('click', () => {
                const title = document.getElementById('projectTitle').value;
                const tags = $('#projectTags').val();
                const members = $('#projectMembers').val();
                const workflows = Array.from(document.querySelectorAll('#projectWorkflows input[type="checkbox"]:checked')).map(cb => cb.value);

                if (!title) {
                    alert("Project title is required!");
                    return;
                }

                const projectCard = createProjectCard(title, tags, members, workflows);
                projectGrid.appendChild(projectCard);

                const modal = new bootstrap.Modal(document.getElementById('createProjectModal'));
                modal.hide();
                document.getElementById('project-form').reset();
                $('#projectTags').val(null).trigger('change');
                $('#projectMembers').val(null).trigger('change');
            });
        });
    </script>
</body>

</html>
